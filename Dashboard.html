<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Shree Sambhaji Raje Housing Society</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="assest/style.css"> <style>
        /* --- CORE VARIABLES & RESET (Matching Login Page) --- */
        :root {
            --primary: #c2410c; /* Orange/Rust */
            --primary-dark: #9a3412;
            --secondary: #1e293b; /* Dark Slate */
            --bg-light: #f1f5f9;
            --text-dark: #334155;
            --text-light: #64748b;
            --card-bg: #ffffff;
            --accent-gold: #fbbf24;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-light);
            color: var(--text-dark);
            margin: 0;
            padding: 0;
            transition: background 0.3s, color 0.3s;
        }

        body.dark-mode {
            background-color: #0f172a;
            color: #e2e8f0;
            --card-bg: #1e293b;
            --text-dark: #f1f5f9;
            --text-light: #cbd5e1;
        }

        /* --- LAYOUT STRUCTURE --- */
        .dashboard-container {
            display: flex;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        /* --- SIDEBAR --- */
        .sidebar {
            width: 260px;
            background: var(--secondary);
            color: white;
            position: fixed;
            top: 0;
            left: -260px; /* Hidden by default */
            height: 100%;
            z-index: 1000;
            transition: left 0.3s ease-in-out;
            box-shadow: 4px 0 15px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
        }

        .sidebar.active {
            left: 0;
        }

        .sidebar-header {
            padding: 20px;
            background: rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .sidebar-menu {
            list-style: none;
            padding: 0;
            margin-top: 20px;
        }

        .sidebar-menu li a {
            display: flex;
            align-items: center;
            padding: 15px 25px;
            color: #cbd5e1;
            text-decoration: none;
            transition: 0.2s;
            border-left: 4px solid transparent;
        }

        .sidebar-menu li a:hover, .sidebar-menu li a.active {
            background: rgba(255,255,255,0.05);
            color: var(--accent-gold);
            border-left-color: var(--accent-gold);
        }

        .sidebar-menu li a i {
            margin-right: 15px;
            width: 20px;
            text-align: center;
        }

        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
        }
        .sidebar-overlay.active { display: block; }

        /* --- MAIN CONTENT AREA --- */
        .main-content {
            flex: 1;
            width: 100%;
            transition: margin-left 0.3s;
        }

        /* --- TOP HEADER --- */
        .top-header {
            background: var(--card-bg);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 900;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .menu-toggle {
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--primary);
        }

        .welcome-text h2 {
            margin: 0;
            font-size: 1.2rem;
        }
        .welcome-text span {
            font-size: 0.9rem;
            color: var(--text-light);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .icon-btn {
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: var(--text-light);
            position: relative;
            transition: 0.2s;
        }
        .icon-btn:hover { color: var(--primary); }

        .lang-select {
            padding: 5px 10px;
            border-radius: 20px;
            border: 1px solid #ddd;
            background: var(--card-bg);
            color: var(--text-dark);
            cursor: pointer;
        }

        /* User Profile Dropdown Styling */
        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }
        .user-avatar {
            width: 40px;
            height: 40px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        /* --- DASHBOARD WIDGETS --- */
        .content-wrapper {
            padding: 30px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: transform 0.2s;
            border-bottom: 4px solid transparent;
        }
        
        .stat-card:hover { transform: translateY(-5px); }

        .stat-info h3 { margin: 0; font-size: 2rem; color: var(--text-dark); }
        .stat-info p { margin: 5px 0 0; color: var(--text-light); font-size: 0.9rem; }
        
        .stat-icon {
            font-size: 2.5rem;
            opacity: 0.2;
            color: var(--primary);
        }

        /* Colors for different cards */
        .card-1 { border-color: #3b82f6; } /* Members */
        .card-2 { border-color: #22c55e; } /* Active */
        .card-3 { border-color: #eab308; } /* House */
        .card-4 { border-color: #ef4444; } /* Requests */
        .card-5 { border-color: #a855f7; } /* Complaint */
        .card-6 { border-color: #06b6d4; } /* Enquiry */

        /* --- SECTIONS GRID --- */
        .sections-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 25px;
        }

        @media (max-width: 900px) {
            .sections-grid { grid-template-columns: 1fr; }
        }

        .section-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            margin-bottom: 25px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        body.dark-mode .section-header { border-color: #334155; }
        .section-header h3 { margin: 0; color: var(--primary); }

        /* Notice Board */
        .notice-list { list-style: none; padding: 0; }
        .notice-item {
            padding: 15px;
            border-left: 4px solid var(--accent-gold);
            background: rgba(251, 191, 36, 0.1);
            margin-bottom: 10px;
            border-radius: 0 8px 8px 0;
        }
        .notice-date { font-size: 0.8rem; color: var(--text-light); font-weight: bold; }

        /* Festival Card */
        .festival-card {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%);
            color: #333;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        body.dark-mode .festival-card {
            background: linear-gradient(135deg, #7f1d1d 0%, #c2410c 100%);
            color: white;
        }
        .festival-icon { font-size: 4rem; margin-bottom: 10px; }

        /* Gallery */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
        }
        .gallery-img {
            width: 100%;
            height: 100px;
            object-fit: cover;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.2s;
        }
        .gallery-img:hover { opacity: 0.8; }

        /* Location */
        .map-container iframe {
            width: 100%;
            height: 250px;
            border: 0;
            border-radius: 10px;
        }

        /* --- RESPONSIVE --- */
        @media (max-width: 768px) {
            .top-header { padding: 15px; }
            .header-right span { display: none; } /* Hide names on mobile */
            .content-wrapper { padding: 15px; }
        }
    </style>
</head>
<body>

    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h3><i class="fa-solid fa-building-user"></i> SSRHS</h3>
            <button class="icon-btn" onclick="toggleSidebar()" style="color:white;"><i class="fa-solid fa-times"></i></button>
        </div>
        <ul class="sidebar-menu">
            <li><a href="#" class="active"><i class="fa-solid fa-chart-line"></i> <span data-key="nav_dashboard">Dashboard</span></a></li>
            <li><a href="#"><i class="fa-solid fa-info-circle"></i> <span data-key="nav_about">About Society</span></a></li>
            <li><a href="#"><i class="fa-solid fa-bullhorn"></i> <span data-key="nav_notice">Notice Board</span></a></li>
            <li><a href="#"><i class="fa-solid fa-clipboard-question"></i> <span data-key="nav_enquiry">Enquiry</span></a></li>
            <li><a href="#"><i class="fa-solid fa-triangle-exclamation"></i> <span data-key="nav_complaint">Complaint</span></a></li>
            <li><a href="#"><i class="fa-solid fa-comments"></i> <span data-key="nav_feedback">Feedback</span></a></li>
            <li><a href="#"><i class="fa-solid fa-hand-holding-hand"></i> <span data-key="nav_request">Requests</span></a></li>
            <li><a href="#"><i class="fa-solid fa-user-clock"></i> <span data-key="nav_visitor">Visitor Gate</span></a></li>
        </ul>
        
        <div style="margin-top: auto; padding: 20px;">
            <button onclick="handleLogout()" style="width:100%; padding:10px; background:rgba(255,255,255,0.1); border:none; color:white; cursor:pointer; border-radius:5px;">
                <i class="fa-solid fa-sign-out-alt"></i> <span data-key="logout">Logout</span>
            </button>
        </div>
    </aside>

    <div class="dashboard-container">
        <div class="main-content">
            
            <nav class="top-header">
                <div class="header-left">
                    <div class="menu-toggle" onclick="toggleSidebar()">
                        <i class="fa-solid fa-bars"></i>
                    </div>
                    <div class="welcome-text">
                        <h2 id="welcomeMsg"><span data-key="welcome">Welcome</span>, User</h2>
                        <span id="dateDisplay">Loading date...</span>
                    </div>
                </div>

                <div class="header-right">
                    <select class="lang-select" onchange="changeLanguage(this.value)">
                        <option value="en">English</option>
                        <option value="mr">मराठी</option>
                        <option value="hi">हिंदी</option>
                    </select>

                    <button class="icon-btn" onclick="toggleDarkMode()" title="Toggle Dark Mode">
                        <i class="fa-solid fa-moon"></i>
                    </button>
                    
                    <button class="icon-btn" title="Settings">
                        <i class="fa-solid fa-gear"></i>
                    </button>

                    <div class="user-profile" onclick="toggleProfileMenu()">
                        <div class="user-avatar" id="userInitials">U</div>
                        <span style="font-weight:bold; font-size:0.9rem;" id="navUserName">User</span>
                    </div>
                </div>
            </nav>

            <div class="content-wrapper">
                
                <div class="stats-grid">
                    <div class="stat-card card-1">
                        <div class="stat-info">
                            <h3 id="countMembers">1,240</h3>
                            <p data-key="stat_members">Total Members</p>
                        </div>
                        <i class="fa-solid fa-users stat-icon"></i>
                    </div>
                    <div class="stat-card card-2">
                        <div class="stat-info">
                            <h3 id="countActive">85</h3>
                            <p data-key="stat_active">Today Active</p>
                        </div>
                        <i class="fa-solid fa-user-check stat-icon"></i>
                    </div>
                    <div class="stat-card card-3">
                        <div class="stat-info">
                            <h3 id="countHouses">450</h3>
                            <p data-key="stat_house">House Count</p>
                        </div>
                        <i class="fa-solid fa-house-chimney stat-icon"></i>
                    </div>
                    <div class="stat-card card-4">
                        <div class="stat-info">
                            <h3 id="countRequests">12</h3>
                            <p data-key="stat_request">Requests Arised</p>
                        </div>
                        <i class="fa-solid fa-bell stat-icon"></i>
                    </div>
                    <div class="stat-card card-5">
                        <div class="stat-info">
                            <h3 id="countComplaints">3</h3>
                            <p data-key="stat_complaint">Complaint Box</p>
                        </div>
                        <i class="fa-solid fa-box-archive stat-icon"></i>
                    </div>
                    <div class="stat-card card-6">
                        <div class="stat-info">
                            <h3 id="countEnquiry">7</h3>
                            <p data-key="stat_enquiry">Enquiry</p>
                        </div>
                        <i class="fa-solid fa-circle-question stat-icon"></i>
                    </div>
                </div>

                <div class="sections-grid">
                    
                    <div class="left-col">
                        <div class="section-card">
                            <div class="section-header">
                                <h3 data-key="sec_notice">Notice Board</h3>
                                <button class="icon-btn"><i class="fa-solid fa-arrow-right"></i></button>
                            </div>
                            <ul class="notice-list">
                                <li class="notice-item">
                                    <div class="notice-date">27 Jan 2026</div>
                                    <div data-key="notice_1">Annual General Meeting scheduled for next Sunday at Club House.</div>
                                </li>
                                <li class="notice-item">
                                    <div class="notice-date">25 Jan 2026</div>
                                    <div data-key="notice_2">Water tank cleaning in Wing A & B. Water supply will be affected.</div>
                                </li>
                                <li class="notice-item">
                                    <div class="notice-date">20 Jan 2026</div>
                                    <div data-key="notice_3">Republic Day celebration photos are uploaded in Gallery.</div>
                                </li>
                            </ul>
                        </div>

                        <div class="section-card">
                            <div class="section-header">
                                <h3 data-key="sec_gallery">Gallery & Events</h3>
                                <button class="icon-btn"><i class="fa-solid fa-images"></i></button>
                            </div>
                            <div class="gallery-grid">
                                <div style="background:#ddd; height:100px; border-radius:8px;"></div>
                                <div style="background:#ccc; height:100px; border-radius:8px;"></div>
                                <div style="background:#bbb; height:100px; border-radius:8px;"></div>
                                <div style="background:#aaa; height:100px; border-radius:8px;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="right-col">
                        
                        <div class="section-card festival-card">
                            <div class="festival-icon"><i class="fa-solid fa-om"></i></div>
                            <h2 data-key="fest_name">Maha Shivratri</h2>
                            <p data-key="fest_desc">Upcoming festival on 14th Feb. Join us for Puja.</p>
                        </div>

                        <div class="section-card">
                            <div class="section-header">
                                <h3 data-key="sec_location">Society Location</h3>
                            </div>
                            <div class="map-container">
                                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d121059.0471115669!2d73.79258476251214!3d18.524598599502376!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3bc2bf2e67461101%3A0x828d43bf9d9ee343!2sPune%2C%20Maharashtra!5e0!3m2!1sen!2sin!4v1700000000000!5m2!1sen!2sin" allowfullscreen="" loading="lazy"></iframe>
                            </div>
                        </div>

                    </div>
                </div>

            </div> </div>
    </div>

    <script>// --- 1. GLOBAL INITIALIZATION & AUTH ---
window.onload = function() {
    // A. Auth Guard: Check if logged in
    if (localStorage.getItem("is_logged_in") !== "true") {
        window.location.href = "index.html"; 
        return;
    }

    // B. Identity & User Profile Display
    updateUserDisplay();

    // C. Initialize Date (Default English)
    updateDateDisplay('en');

    // D. Load and Animate Live Stats
    loadLiveStats();
};

// Function to handle identity UI
function updateUserDisplay() {
    const userName = localStorage.getItem("user_name") || "Member";
    const firstName = userName.split(" ")[0]; 
    
    // Welcome message with span for translation key
    const welcomeEl = document.getElementById('welcomeMsg');
    if(welcomeEl) {
        welcomeEl.innerHTML = `<span data-key="welcome">Welcome</span>, ${userName}`;
    }
    
    if(document.getElementById('navUserName')) 
        document.getElementById('navUserName').innerText = firstName;
    
    if(document.getElementById('userInitials')) 
        document.getElementById('userInitials').innerText = firstName.charAt(0).toUpperCase();
}

// Function to fetch stats from LocalStorage and animate them
function loadLiveStats() {
    const stats = JSON.parse(localStorage.getItem("dash_stats")) || {};
    
    const mapping = {
        'countMembers': stats.members,
        'countActive': stats.active,
        'countComplaints': stats.complaints,
        'countEnquiry': stats.enquiries,
        'countFeedback': stats.feedback,
        'countRequests': stats.requests,
        'countNotices': stats.notices,
        'countRegistrations': stats.registrations
    };

    for (const [id, value] of Object.entries(mapping)) {
        const element = document.getElementById(id);
        if (element) {
            animateValue(element, 0, value || 0, 1200);
        }
    }
}

// Helper: Animate numbers
function animateValue(obj, start, end, duration) {
    let startTimestamp = null;
    const step = (timestamp) => {
        if (!startTimestamp) startTimestamp = timestamp;
        const progress = Math.min((timestamp - startTimestamp) / duration, 1);
        obj.innerHTML = Math.floor(progress * (end - start) + start);
        if (progress < 1) window.requestAnimationFrame(step);
    };
    window.requestAnimationFrame(step);
}

// --- 2. CORE ACTIONS: LOGOUT & UI TOGGLES ---
function handleLogout() {
    if(confirm("Are you sure you want to logout?")) {
        localStorage.clear(); // Clears login and stats
        window.location.href = "index.html";
    }
}

function toggleSidebar() {
    const sb = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebarOverlay');
    if(sb) sb.classList.toggle('active');
    if(overlay) overlay.classList.toggle('active');
}

function toggleDarkMode() {
    document.body.classList.toggle('dark-mode');
    const isDark = document.body.classList.contains('dark-mode');
    localStorage.setItem("theme", isDark ? "dark" : "light");
}

// --- 3. LANGUAGE TRANSLATION LOGIC ---
const translations = {
    en: {
        welcome: "Welcome",
        nav_dashboard: "Dashboard",
        nav_about: "About Society",
        nav_notice: "Notice Board",
        nav_enquiry: "Enquiry",
        nav_complaint: "Complaint",
        nav_feedback: "Feedback",
        nav_request: "Requests",
        nav_visitor: "Visitor Gate",
        logout: "Logout",
        stat_members: "Total Members",
        stat_active: "Today Active",
        sec_notice: "Notice Board",
        sec_gallery: "Gallery & Events",
        fest_name: "Maha Shivratri",
        fest_desc: "Upcoming festival on 14th Feb. Join us for Puja."
    },
    mr: {
        welcome: "स्वागत आहे",
        nav_dashboard: "डॅशबोर्ड",
        nav_about: "सोसायटीबद्दल",
        nav_notice: "सूचना फलक",
        nav_enquiry: "चौकशी",
        nav_complaint: "तक्रार पेटी",
        nav_feedback: "अभिप्राय",
        nav_request: "विनंत्या",
        nav_visitor: "व्हिजिटर गेट",
        logout: "बाहेर पडणे",
        stat_members: "एकूण सदस्य",
        stat_active: "आज सक्रिय",
        sec_notice: "सूचना फलक",
        sec_gallery: "गॅलरी आणि कार्यक्रम",
        fest_name: "महाशिवरात्री",
        fest_desc: "14 फेब्रुवारी रोजी उत्सव. पूजेसाठी सामील व्हा."
    },
    hi: {
        welcome: "स्वागत है",
        nav_dashboard: "डैशबोर्ड",
        nav_about: "सोसाइटी के बारे में",
        nav_notice: "सूचना पट्ट",
        nav_enquiry: "पूछताछ",
        nav_complaint: "शिकायत",
        nav_feedback: "प्रतिक्रिया",
        nav_request: "अनुरोध",
        nav_visitor: "आगंतुक गेट",
        logout: "लॉग आउट",
        stat_members: "कुल सदस्य",
        stat_active: "आज सक्रिय",
        sec_notice: "सूचना पट्ट",
        sec_gallery: "गैलरी और कार्यक्रम",
        fest_name: "महाशिवरात्रि",
        fest_desc: "14 फरवरी को आगामी त्योहार। पूजा के लिए शामिल हों।"
    }
};

function changeLanguage(lang) {
    // Update all elements with data-key attribute
    const elements = document.querySelectorAll('[data-key]');
    elements.forEach(el => {
        const key = el.getAttribute('data-key');
        if (translations[lang] && translations[lang][key]) {
            // If it's the welcome message, preserve the user name
            if(key === 'welcome') {
                const userName = localStorage.getItem("user_name") || "Member";
                el.parentElement.innerHTML = `<span data-key="welcome">${translations[lang][key]}</span>, ${userName}`;
            } else {
                el.innerText = translations[lang][key];
            }
        }
    });

    updateDateDisplay(lang);
}

function updateDateDisplay(lang) {
    const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
    const locale = lang === 'en' ? 'en-US' : (lang === 'mr' ? 'mr-IN' : 'hi-IN');
    const el = document.getElementById('dateDisplay');
    if(el) el.innerText = new Date().toLocaleDateString(locale, dateOptions);
}</script>
</body>
</html>